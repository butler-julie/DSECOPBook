

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Using Linear Regression to Extract Physical Constants: Newtonian Gravitation &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'DSECOP/Machine_Learning_Workflow/0_2_newtonian_gravitation_with_linear_regression';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Table of Contents
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Exploratory Data Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Exploratory_Data_Analysis/README.html">Exploratory Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Exploratory_Data_Analysis/01_dataset_cleaning.html">Exploratory Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Exploratory_Data_Analysis/02_preprocessing_techniques.html">Preprocessing Techniques for Machine Learning</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FDSECOP/Machine_Learning_Workflow/0_2_newtonian_gravitation_with_linear_regression.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/DSECOP/Machine_Learning_Workflow/0_2_newtonian_gravitation_with_linear_regression.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Using Linear Regression to Extract Physical Constants: Newtonian Gravitation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#important">IMPORTANT!</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-a-model">Building A Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-and-format-the-data-set">Import and Format the Data Set</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#practice-what-you-have-learned">Practice What You Have Learned</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="using-linear-regression-to-extract-physical-constants-newtonian-gravitation">
<h1>Using Linear Regression to Extract Physical Constants: Newtonian Gravitation<a class="headerlink" href="#using-linear-regression-to-extract-physical-constants-newtonian-gravitation" title="Permalink to this headline">#</a></h1>
<p>Author: Julie Butler, <a class="reference external" href="mailto:butle222&#37;&#52;&#48;msu&#46;edu">butle222<span>&#64;</span>msu<span>&#46;</span>edu</a></p>
<p>Date Created: October 15, 2022</p>
<p>Last Modified: November 7, 2022</p>
<p>Notebook 2/5 of the DSECOP Module: An Introduction to the Machine Learning Workflow with Linear Regression.  See the entire module <span class="xref myst">here</span>.</p>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">#</a></h2>
<p>First let’s import the necessary packages needed to run this notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################</span>
<span class="c1">##          IMPORTS         ##</span>
<span class="c1">##############################</span>
<span class="c1"># Needed for arrays and mathematical functions</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># For plotting</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># For importing and formatting data sets</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># For the machine learning section, their functions will be explained later in</span>
<span class="c1"># the notebook</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</pre></div>
</div>
</div>
</div>
<p>Now we need to set up the notebook to sync with Google Drive.  There will be some pop-up windows you will need to follow the prompts on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># GOOGLE DRIVE SET UP</span>
<span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="c1"># Mount my Google Drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/gdrive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># GOOGLE DRIVE SET UP</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1"># Mount my Google Drive</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/gdrive&#39;</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;google&#39;
</pre></div>
</div>
</div>
</div>
<section id="important">
<h3>IMPORTANT!<a class="headerlink" href="#important" title="Permalink to this headline">#</a></h3>
<p><strong>Problem 1:</strong> Change the below line to match the file directory where the notebooks and data are stored on your Google Drive.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Directory to retrieve data files from (###CHANGE THIS###)</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="s1">&#39;/content/gdrive/My Drive/Teaching/DSECOP/Module 2: Workflow/&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="building-a-model">
<h2>Building A Model<a class="headerlink" href="#building-a-model" title="Permalink to this headline">#</a></h2>
<p>Given a star which has a mass of <span class="math notranslate nohighlight">\(m_1\)</span> and is at location <span class="math notranslate nohighlight">\(\vec{r}_1\)</span> and a planet which has a mass of <span class="math notranslate nohighlight">\(m_2\)</span> and is at location <span class="math notranslate nohighlight">\(\vec{r}_2\)</span>, then the graviational force on the planet due to the star is:</p>
<div class="math notranslate nohighlight">
\[\vec{F}_{G,21} = -G\frac{m_1m_2}{r_{21}^2}\hat{r}_{21},\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{r}_{21} = \vec{r}_1 - \vec{r}_2\)</span>.</p>
<p>However we also know that the net force on an object is given by Newton’s second law:</p>
<div class="math notranslate nohighlight">
\[\vec{F}_{net} = m\vec{a},\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{a}\)</span> is the acceleration of the object.</p>
<p>If we assume that the only force acting on our planet is the gravitaional force due to being near the star, then its net force and the Newtonian gravitaional force equation are equivalent.  To simplfy calculations we will also only consider the magnitudes of both equations.</p>
<div class="math notranslate nohighlight">
\[\vec{F}_{G,21} = \vec{F}_{net} \longrightarrow F_{G,21} = F_{net}\]</div>
<p>We can expand both equations using the above definitions, where the <span class="math notranslate nohighlight">\(m\)</span> in the net force equation is <span class="math notranslate nohighlight">\(m_1\)</span>, the mass of the planet (i.e. the object who’s motion we are studying).</p>
<div class="math notranslate nohighlight">
\[-G\frac{m_1m_2}{r_{21}^2} = m_2a\]</div>
<p>We can simplify these equations a bit further by doing some algebra:</p>
<div class="math notranslate nohighlight">
\[a = \frac{Gm_1}{r_{21}^2} = -Gm_1\frac{1}{r_{21}^2}\]</div>
<p>Now, let’s separate the constants from the physical values and we know that both acceleration and position are time dependent, so we can add in a notation that reflects this.</p>
<div class="math notranslate nohighlight">
\[a(t) =  Gm_1\frac{1}{r_{12}(t)^2}\]</div>
<p>Now, let’s look at the equation for the output of the linear regression algorithm and compare it to the equation for acceleration which we have just derived.</p>
<div class="math notranslate nohighlight">
\[\hat{y} = X\theta\]</div>
<p>By comparing the equation for a(t) to the equation for <span class="math notranslate nohighlight">\(\hat{y}\)</span>, we can begin to see how we can format your acceleration equation as a linear regression problem.  First, we can see that <span class="math notranslate nohighlight">\(\hat{y}\)</span> will be the acceleration of our planet, which we can expand as a vector for each time step we have data on, for a total of N data points.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{y} = a(t)\ = \ \begin{bmatrix}
    a(t_0) \
    a(t_1) \\
    a(t_2) \\
    . \\
    . \\
    . \\
    a(t_N)
\end{bmatrix}\end{split}\]</div>
<p>We can also see that our X data will be the inverse squared position, which we can represent in vector form based on time steps as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}X\ =\ \frac{1}{r_{21}^2(t)}\ =\ \begin{bmatrix}
    1/r_{21}^2(t_0) \\
    1/r_{21}^2(t_1) \\
    1/r_{21}^2(t_2) \\
    . \\
    . \\
    . \\
    1/r_{21}^2(t_N) \\
\end{bmatrix}\end{split}\]</div>
<p>Here, we can take a moment to simplify the notation since we only have two objects in total, the planet and the star.  For the remainer of this problem we will simplify the notation to r<span class="math notranslate nohighlight">\(_{12}\)</span> <span class="math notranslate nohighlight">\(\rightarrow\)</span> r<span class="math notranslate nohighlight">\(_2\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}X\ =\ \frac{1}{r_{2}^2(t)}\ =\ \begin{bmatrix}
    1/r_{2}^2(t_0) \\
    1/r_{2}^2(t_1) \\
    1/r_{2}^2(t_2) \\
    . \\
    . \\
    . \\
    1/r_{2}^2(t_N) \\
\end{bmatrix}\end{split}\]</div>
<p>Finally, the weights, <span class="math notranslate nohighlight">\(\theta\)</span>, will be the gravitational constant, G, multiplied by the mass of the sun, m<span class="math notranslate nohighlight">\(_1\)</span>.</p>
<div class="math notranslate nohighlight">
\[\theta = Gm_1\]</div>
<p>The goal of this linear regression analysis will be to determine the value of m<span class="math notranslate nohighlight">\(_1\)</span>, the mass of the star the planet is orbiting.</p>
<section id="import-and-format-the-data-set">
<h3>Import and Format the Data Set<a class="headerlink" href="#import-and-format-the-data-set" title="Permalink to this headline">#</a></h3>
<p>The data needed for this problem is stored in the file <code class="docutils literal notranslate"><span class="pre">data_notebook_2_one_planet.csv</span></code>.  Before we attempt to apply linear regression to this problem we will need to import and format the data set.</p>
<p><strong>Problem 2:</strong> Import the data set as a Pandas dataframe and print the first few lines.</p>
<p><strong>Problem 3:</strong> Remembering that a subscript of “2” represents data collected about the planet, what data is provided for this problem.  Write your response in the textbox below.  In the code cell below that, convert each column of the data file to a NumPy array, saving the NumPy arrays with useful and descriptive names (i.e. t, a, v, and r).</p>
<p>Now we need to create the design matrix, X = 1/r<span class="math notranslate nohighlight">\(^2\)</span>.  However, since we were given just the position, we will need to perform some manipulations to create our design matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r_squared</span> <span class="o">=</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span> 
<span class="n">r_squared_inverse</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">r_squared</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">r_squared_inverse</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we need to split our data into a training set and a test set.</p>
<p><strong>Problem 4:</strong> Using the Scikit-Learn function <code class="docutils literal notranslate"><span class="pre">train_test_split</span></code> split the X and y data sets into training and test sets.  Use 20% of the data as the test set and the remainder as the training set.</p>
<p>Since our X data set only has one feature (i.e. its a vector instead of a matrix) we will need to reshape the X components of our training and test data sets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Problem 5:</strong> Using Scikit-Learn’s linear regression model:</p>
<ul class="simple">
<li><p>Define a linear regression model, remembering to set <code class="docutils literal notranslate"><span class="pre">fit_intercept</span></code> to False</p></li>
<li><p>Train the model using the training data</p></li>
<li><p>Predict the values of the test set and store the predictions for later use</p></li>
</ul>
<p>Now let’s define a function that will calculate the mean-squared error between two data sets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mse</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">((</span><span class="n">A</span><span class="o">-</span><span class="n">B</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Problem 6:</strong> Using the MSE function defined above, calculate the MSE between the test data set and the predictions. Based in the MSE, is the machine learning model a good match for the data?</p>
<p><strong>Problem 7:</strong>. Finally, graph the test data set and the predicted data set as a function of time (remember that the y component of each data set is acceleration).  Make sure you have a legend on your graph and label the x and y axes.</p>
<p>Finally, let’s extract the linear regression weights to see if we can extract the mass of the star.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="n">LiR</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Problem 8:</strong> Finally, perform a mathematical operation on the linear regression weight to recover the mass of the star.  Remember that G = 6.67x10<span class="math notranslate nohighlight">\(^{-11}\)</span> <span class="math notranslate nohighlight">\(\frac{N m^2}{kg^2}\)</span>.  The mass of the star used in the simulation to create the data set is 8x10<span class="math notranslate nohighlight">\(^{28}\)</span>.  How close is your result?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span><span class="o">/</span><span class="mf">6.67e-11</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="practice-what-you-have-learned">
<h2>Practice What You Have Learned<a class="headerlink" href="#practice-what-you-have-learned" title="Permalink to this headline">#</a></h2>
<p>Let’s assume that we have a system that contains two objects, object 1 (mass = <span class="math notranslate nohighlight">\(m_1\)</span>, location = <span class="math notranslate nohighlight">\(\vec{r}_1\)</span>) and object 2 (mass = <span class="math notranslate nohighlight">\(m_2\)</span>, location = <span class="math notranslate nohighlight">\(\vec{r}_2\)</span>).  These two objects have a strange interaction but after much study we have been able to determine that the force on object 1 caused by object 2 can be modelled by the following equation:</p>
<div class="math notranslate nohighlight">
\[\vec{F}_{12} = \frac{m_1^2m_2}{(\vec{r}_2-\vec{r}_1)^3} + \frac{m_1}{m_2}(\vec{r}_2-\vec{r}_1)\]</div>
<p>Unfortunately, we have not been able to determine their masses. However, we have been able to record their relative positions and the acceleration of the first object. Using this information, you are asked to determine the mass of the two objects.</p>
<p>a. Before we begin coding, we need to develop a theoretical model to try to match.  Using the above force equation and Newton’s second law, write an equation that relates the acceleration of object 1 to the relative distance between the two objects.</p>
<p>b. Using your equation from part a and the equation for linear regression (<span class="math notranslate nohighlight">\(\hat{y} = X\theta\)</span>), figure out which values correspond to <span class="math notranslate nohighlight">\(\hat{y}\)</span>, X, and <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<p>c. The data for this problem is stored in <code class="docutils literal notranslate"><span class="pre">data_notebook_2_objects</span></code>.  Import the data as a Pandas dataframe and print the first few lines.  The columns, in order, are: the time (in seconds), the acceleration of object 2 (m/s<span class="math notranslate nohighlight">\(^2\)</span>), the velocity of object 2 (m/s), and the relative position between the two objects (i.e. r<span class="math notranslate nohighlight">\(_2\)</span> - r<span class="math notranslate nohighlight">\(_1\)</span>, measured in m).  Extract these columns each as a separate NumPy array and save them with useful names.</p>
<p>d. Create a design matrix X using the imported data that corresponds to your answers to parts a and b.</p>
<p>e. Using the function <code class="docutils literal notranslate"><span class="pre">train_test_split</span></code> from Scikit-Learn, split your data into a training set and a test set. Use 20% of the data as the test data set.</p>
<p>f. Using Scikit-Learn’s linear regression model:</p>
<ul class="simple">
<li><p>Define a linear regression model, remembering to set <code class="docutils literal notranslate"><span class="pre">fit_intercept</span></code> to False</p></li>
<li><p>Train the model using the training data</p></li>
<li><p>Predict the values of the test set and store the predictions for later use</p></li>
</ul>
<p>g. Calculate the MSE error between the test data set and the predicted data set.  Based on this error, is the machine learning model a good fit for the data?</p>
<p>h. Plot the predicted and test data sets on the same graph as a function of time.  Make sure you label your axes and add a legend.</p>
<p>i. Extract the linear regression weights and use them to extract m<span class="math notranslate nohighlight">\(_1\)</span> and m<span class="math notranslate nohighlight">\(_2\)</span>.  The values of m<span class="math notranslate nohighlight">\(_1\)</span> and m<span class="math notranslate nohighlight">\(_2\)</span> used to generate the data were 5kg and 7kg respectively.  How close were your answers?</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./DSECOP/Machine_Learning_Workflow"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#important">IMPORTANT!</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-a-model">Building A Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-and-format-the-data-set">Import and Format the Data Set</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#practice-what-you-have-learned">Practice What You Have Learned</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>